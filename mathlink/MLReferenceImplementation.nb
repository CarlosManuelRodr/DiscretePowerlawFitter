(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     91938,       2229]
NotebookOptionsPosition[     86077,       2126]
NotebookOutlinePosition[     86547,       2144]
CellTagsIndexPosition[     86504,       2141]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Discrete Power-law fitter", "Title",
 CellChangeTimes->{{3.854639174702952*^9, 
  3.8546391789811487`*^9}},ExpressionUUID->"d598f596-2801-4778-8c27-\
dca3abeee197"],

Cell[CellGroupData[{

Cell["Model extensions", "Chapter",
 CellChangeTimes->{{3.856971071042368*^9, 3.856971075750937*^9}, {
  3.856989429232291*^9, 
  3.85698943259306*^9}},ExpressionUUID->"0b871386-a10f-4f47-bdb9-\
df266cbf560a"],

Cell[TextData[{
 "For the bounded model in the range ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["x", "min"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3a03f312-d3cf-4f92-a23b-7d1c235a4a6a"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "max"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "45735395-6a85-4752-8c70-be461a1c787a"],
 "]"
}], "Text",
 CellChangeTimes->{{3.856971080223123*^9, 
  3.856971103117182*^9}},ExpressionUUID->"89e4dd4a-9755-4f11-a6a0-\
b742854b9312"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"x", "=", "xMin"}], "xMax"], 
     RowBox[{
      RowBox[{"C", "[", 
       RowBox[{"\[Alpha]", ",", "x"}], "]"}], " ", 
      SuperscriptBox["x", 
       RowBox[{"-", "\[Alpha]"}]]}]}], " ", "==", " ", "1"}], ",", 
   RowBox[{"C", "[", 
    RowBox[{"\[Alpha]", ",", "x"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"36148f69-bb5e-44bf-a19e-87e6abe82f0d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"C", "[", 
     RowBox[{"\[Alpha]", ",", "x"}], "]"}], "\[Rule]", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"HurwitzZeta", "[", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"1", "+", "xMax"}]}], "]"}]}], "+", 
      RowBox[{"HurwitzZeta", "[", 
       RowBox[{"\[Alpha]", ",", "xMin"}], "]"}]}]]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{3.856971105648089*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"27c0ba0c-1fd0-40e1-bf25-7fb77384b5c6"]
}, Open  ]],

Cell["That is:", "Text",
 CellChangeTimes->{{3.85697111394046*^9, 3.856971145306857*^9}, 
   3.8575770260736628`*^9},ExpressionUUID->"d030ddc0-840c-406f-9fed-\
a6c33bd48ea1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"x_", ",", "\[Alpha]_", ",", "xMin_", ",", "xMax_"}], "]"}], ":=", 
   FractionBox[
    SuperscriptBox["x", 
     RowBox[{"-", "\[Alpha]"}]], 
    RowBox[{
     RowBox[{"HurwitzZeta", "[", 
      RowBox[{"\[Alpha]", ",", "xMin"}], "]"}], "-", 
     RowBox[{"HurwitzZeta", "[", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"1", "+", "xMax"}]}], "]"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.856971149242259*^9, 3.856971197561537*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"2d935fb8-71fe-4cc1-96ea-a6df538f29de"],

Cell["The form of the CDF therefore is:", "Text",
 CellChangeTimes->{{3.856971354628522*^9, 3.856971363436955*^9}, 
   3.857577022881713*^9},ExpressionUUID->"17b93fbd-3e47-4383-a4b6-\
b997a08de08f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  UnderoverscriptBox["\[Sum]", 
   RowBox[{"xp", "=", "x"}], "xMax"], 
  RowBox[{"p", "[", 
   RowBox[{"xp", ",", "\[Alpha]", ",", "xMin", ",", "xMax"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.856971368576035*^9, 3.856971406999098*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"2d293e8d-5a45-4bbc-b068-e3ae5b31ba38"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"HurwitzZeta", "[", 
    RowBox[{"\[Alpha]", ",", "x"}], "]"}], "-", 
   RowBox[{"HurwitzZeta", "[", 
    RowBox[{"\[Alpha]", ",", 
     RowBox[{"1", "+", "xMax"}]}], "]"}]}], 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Zeta", "[", 
     RowBox[{"\[Alpha]", ",", 
      RowBox[{"1", "+", "xMax"}]}], "]"}]}], "+", 
   RowBox[{"Zeta", "[", 
    RowBox[{"\[Alpha]", ",", "xMin"}], "]"}]}]]], "Output",
 CellChangeTimes->{3.8569714078982077`*^9, 3.8569714679988327`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"880ea395-337c-43dd-8736-2631998247b3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"x_", ",", "\[Alpha]_", ",", "xMin_", ",", "xMax_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"HurwitzZeta", "[", 
      RowBox[{"\[Alpha]", ",", "x"}], "]"}], "-", 
     RowBox[{"HurwitzZeta", "[", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"1", "+", "xMax"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"HurwitzZeta", "[", 
      RowBox[{"\[Alpha]", ",", "xMin"}], "]"}], "-", 
     RowBox[{"HurwitzZeta", "[", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"1", "+", "xMax"}]}], "]"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.8569770758597183`*^9, 3.856977092647608*^9}, {
  3.857063849948331*^9, 3.857063860485725*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"aa3cbd4b-3d23-4651-910b-7ca458849cd0"],

Cell["Thus, the log-likelihood can be expressed as:", "Text",
 CellChangeTimes->{{3.8569776729877033`*^9, 3.856977681154684*^9}, {
   3.856989446238554*^9, 3.85698944913629*^9}, 
   3.857577021383473*^9},ExpressionUUID->"a8c6d9c9-a6f0-4eb2-ad19-\
16292a5a4ed4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "@", 
  RowBox[{"PowerExpand", "@", 
   RowBox[{"Log", "[", 
    RowBox[{"Product", "[", 
     RowBox[{
      FractionBox[
       SuperscriptBox["x", 
        RowBox[{"-", "\[Alpha]"}]], 
       RowBox[{
        RowBox[{"HurwitzZeta", "[", 
         RowBox[{"\[Alpha]", ",", "xMin"}], "]"}], "-", 
        RowBox[{"HurwitzZeta", "[", 
         RowBox[{"\[Alpha]", ",", 
          RowBox[{"1", "+", "xMax"}]}], "]"}]}]], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}]}], 
       "}"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.856978060756137*^9, 3.856978131438814*^9}, {
  3.856978237235355*^9, 3.856978248796101*^9}, {3.8569784497531967`*^9, 
  3.8569784501811666`*^9}, {3.8569784818561277`*^9, 3.8569785465479317`*^9}, {
  3.856978582547423*^9, 3.856978604915482*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"34b524a6-4d94-4956-a171-e4721cbc54a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[Alpha]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Log", "[", "x1", "]"}], "+", 
     RowBox[{"Log", "[", "x2", "]"}], "+", 
     RowBox[{"Log", "[", "x3", "]"}], "+", 
     RowBox[{"Log", "[", "x4", "]"}], "+", 
     RowBox[{"Log", "[", "x5", "]"}]}], ")"}]}], "-", 
  RowBox[{"5", " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"HurwitzZeta", "[", 
       RowBox[{"\[Alpha]", ",", 
        RowBox[{"1", "+", "xMax"}]}], "]"}]}], "+", 
     RowBox[{"HurwitzZeta", "[", 
      RowBox[{"\[Alpha]", ",", "xMin"}], "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.8569780994786253`*^9, 3.856978131932137*^9}, {
   3.856978234326251*^9, 3.8569782492862*^9}, 3.8569784505794067`*^9, {
   3.856978482248859*^9, 3.8569785470903387`*^9}, {3.8569785842605352`*^9, 
   3.8569786054590797`*^9}},
 CellLabel->"Out[81]=",ExpressionUUID->"3f40652f-55b0-4c64-8522-ec75a6d4ea5a"]
}, Open  ]],

Cell["That is, for an arbitrary sized sample:", "Text",
 CellChangeTimes->{{3.856978681341518*^9, 3.856978682166902*^9}, {
  3.8575770096267*^9, 
  3.8575770193973093`*^9}},ExpressionUUID->"a405a4a4-ebbf-4507-afff-\
4b6561fbc8ee"],

Cell[BoxData[
 RowBox[{"L", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", " ", "n"}], " ", "*", " ", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"HurwitzZeta", "[", 
       RowBox[{"alpha", ",", "xMin"}], "]"}], "-", 
      RowBox[{"HurwitzZeta", "[", 
       RowBox[{"\[Alpha]", ",", 
        RowBox[{"1", "+", "xMax"}]}], "]"}]}], "]"}]}], "-", 
   RowBox[{"\[Alpha]", " ", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], "n"], 
     RowBox[{"Log", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.856978695365321*^9, 
  3.856978797827366*^9}},ExpressionUUID->"0cb40b13-d6ef-4865-9fd1-\
28fd0f55796b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Chapter",
 CellChangeTimes->{{3.8569710658126497`*^9, 
  3.856971069002142*^9}},ExpressionUUID->"f8d96c95-45f2-4141-baff-\
f3921e54f11f"],

Cell[BoxData[
 RowBox[{"Needs", "[", 
  RowBox[{"\"\<ProgressMapping`\>\"", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<ProgressMapping.wl\>\""}], "}"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.854647387248567*^9, 3.854647387251067*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ea06bf2b-47a9-4df9-a1c3-95c1b9085f4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DiscretePowerLawDistributionPDF", "[", 
    RowBox[{"\[Alpha]_", ",", "xMin_", ",", "x_"}], "]"}], ":=", 
   FractionBox[
    SuperscriptBox["x", 
     RowBox[{"-", "\[Alpha]"}]], 
    RowBox[{"HurwitzZeta", "[", 
     RowBox[{"\[Alpha]", ",", "xMin"}], "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DiscretePowerLawDistributionPDF", "[", 
     RowBox[{"\[Alpha]_", ",", "xMin_", ",", "xMax_", ",", "x_"}], "]"}], ":=", 
    FractionBox[
     SuperscriptBox["x", 
      RowBox[{"-", "\[Alpha]"}]], 
     RowBox[{
      RowBox[{"HurwitzZeta", "[", 
       RowBox[{"\[Alpha]", ",", "xMin"}], "]"}], "-", 
      RowBox[{"HurwitzZeta", "[", 
       RowBox[{"\[Alpha]", ",", 
        RowBox[{"1", "+", "xMax"}]}], "]"}]}]]}], ";"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DiscretePowerLawDistributionCDF", "[", 
    RowBox[{"\[Alpha]_", ",", "xMin_", ",", "x_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"HurwitzZeta", "[", 
     RowBox[{"\[Alpha]", ",", "x"}], "]"}], 
    RowBox[{"HurwitzZeta", "[", 
     RowBox[{"\[Alpha]", ",", "xMin"}], "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DiscretePowerLawDistributionCDF", "[", 
    RowBox[{"\[Alpha]_", ",", "xMin_", ",", "xMax_", ",", "x_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"HurwitzZeta", "[", 
      RowBox[{"\[Alpha]", ",", "x"}], "]"}], "-", 
     RowBox[{"HurwitzZeta", "[", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"1", "+", "xMax"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"Zeta", "[", 
      RowBox[{"\[Alpha]", ",", "xMin"}], "]"}], "-", 
     RowBox[{"Zeta", "[", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"1", "+", "xMax"}]}], "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmpiricalCDF", "[", 
    RowBox[{"data_", ",", "x_"}], "]"}], ":=", " ", 
   RowBox[{"N", "[", 
    RowBox[{"1", "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"EmpiricalDistribution", "[", "data", "]"}], ",", 
       RowBox[{"x", "-", "1"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeneratePowerlawSampleData", "[", 
    RowBox[{"\[Alpha]_", ",", "xMin_", ",", "xMax_", ",", 
     RowBox[{"sampleSize_", " ", ":", "1000"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "dist", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dist", " ", "=", " ", 
       RowBox[{"ProbabilityDistribution", "[", 
        RowBox[{
         RowBox[{"DiscretePowerLawDistributionPDF", "[", 
          RowBox[{"\[Alpha]", ",", "xMin", ",", "xMax", ",", "x"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "xMin", ",", "xMax", ",", "1"}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"dist", ",", "sampleSize"}], "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.846435065800014*^9, 3.84643515944833*^9}, {
  3.8464371478413267`*^9, 3.846437156620235*^9}, {3.84643831536322*^9, 
  3.84643831659608*^9}, {3.854639387696631*^9, 3.8546393879468603`*^9}, {
  3.8546395631150427`*^9, 3.854639583972419*^9}, {3.855151185293474*^9, 
  3.855151185443304*^9}, {3.8569771537066393`*^9, 3.856977194791217*^9}, {
  3.8571630296336317`*^9, 3.857163031107353*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"58a37c1e-fe03-4d2e-af23-031428dc3f7c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HistogramPoints", "[", "data_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{"N", "[", 
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"data", ",", "#"}], "]"}], 
          RowBox[{"Length", "[", "data", "]"}]], "]"}]}], "}"}], "&"}], ",", 
     RowBox[{"Sort", "[", 
      RowBox[{"DeleteDuplicates", "[", "data", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HistogramPointPlots", "[", 
    RowBox[{"data_List", ",", 
     RowBox[{"opts", ":", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pltData", " ", "=", " ", 
       RowBox[{"HistogramPoints", "[", "data", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
      RowBox[{"pltData", ",", "\[IndentingNewLine]", 
       RowBox[{"Joined", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotTheme", "\[Rule]", "\"\<Monochrome\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"FontSize", "\[Rule]", "14"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "Large", "]"}], ",", 
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<Legacy\>\"", "]"}], "[", 
           "\"\<IndianRed\>\"", "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"ImageSize", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotMarkers", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{"GridLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "All"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"GridLinesStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Gray", ",", 
          RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{"Options", "[", "ListPlot", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855247798972888*^9, 3.855247803621234*^9}, {
  3.855247876132646*^9, 3.855247877122182*^9}, {3.855247910387842*^9, 
  3.8552479130153503`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"ae494851-bc7d-4ec3-8b08-41a5e3d014bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SelectTail", "[", 
    RowBox[{"data_", ",", "xMin_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"data", ",", 
     RowBox[{
      RowBox[{"#", ">=", "xMin"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectTruncatedTail", "[", 
    RowBox[{"data_", ",", "xMin_", ",", "xMax_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"data", ",", 
     RowBox[{
      RowBox[{"xMin", "<=", "#", "<=", "xMax"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SelectBulk", "[", 
     RowBox[{"data_", ",", "xMin_"}], "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{"data", ",", 
      RowBox[{
       RowBox[{"#", "<", "xMin"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateLogLikelihood", "[", 
    RowBox[{"data_", ",", "alpha_", ",", " ", "xMin_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tail", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tail", " ", "=", " ", 
       RowBox[{"SelectTail", "[", 
        RowBox[{"data", ",", "xMin"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", "tail", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "n"}], " ", "*", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"HurwitzZeta", "[", 
           RowBox[{"alpha", ",", "xMin"}], "]"}], "]"}]}], "-", 
        RowBox[{"alpha", " ", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "n"], 
          RowBox[{"Log", "[", 
           RowBox[{"tail", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateLogLikelihood", "[", 
    RowBox[{"data_", ",", "alpha_", ",", " ", "xMin_", ",", "xMax_"}], "]"}], 
   ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tail", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tail", " ", "=", " ", 
       RowBox[{"SelectTruncatedTail", "[", 
        RowBox[{"data", ",", "xMin", ",", "xMax"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", "tail", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "n"}], " ", "*", " ", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"HurwitzZeta", "[", 
            RowBox[{"alpha", ",", "xMin"}], "]"}], "-", 
           RowBox[{"HurwitzZeta", "[", 
            RowBox[{"alpha", ",", 
             RowBox[{"1", "+", "xMax"}]}], "]"}]}], "]"}]}], "-", 
        RowBox[{"alpha", " ", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "n"], 
          RowBox[{"Log", "[", 
           RowBox[{"tail", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Estimate\[Alpha]Precise", "[", 
    RowBox[{"data_", ",", "xMin_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tail", ",", "L"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tail", " ", "=", " ", 
       RowBox[{"SelectTail", "[", 
        RowBox[{"data", ",", "xMin"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"L", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", 
           RowBox[{"CalculateLogLikelihood", "[", 
            RowBox[{"tail", ",", "\[Alpha]", ",", " ", "xMin"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1.5", ",", "3.51", ",", "0.01"}], "}"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alpha\>\"", "->", 
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"L", ",", "Last"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"\"\<xMin\>\"", "->", "xMin"}]}], "|>"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Estimate\[Alpha]Precise", "[", 
    RowBox[{"data_", ",", "xMin_", ",", "xMax_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tail", ",", "L"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tail", " ", "=", " ", 
       RowBox[{"SelectTruncatedTail", "[", 
        RowBox[{"data", ",", "xMin", ",", "xMax"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"L", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", 
           RowBox[{"CalculateLogLikelihood", "[", 
            RowBox[{"tail", ",", "\[Alpha]", ",", " ", "xMin", ",", "xMax"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1.5", ",", "3.51", ",", "0.01"}], "}"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alpha\>\"", "->", 
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"L", ",", "Last"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"\"\<xMin\>\"", "->", "xMin"}], ",", 
        RowBox[{"\"\<xMax\>\"", "->", "xMax"}]}], "|>"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.854639256832531*^9, 3.8546393273686657`*^9}, {
   3.8546394214324303`*^9, 3.854639425963347*^9}, {3.854639925587644*^9, 
   3.8546399415351667`*^9}, {3.854640097509407*^9, 3.854640109167981*^9}, {
   3.854645644475971*^9, 3.85464568669198*^9}, {3.854721404716267*^9, 
   3.8547214346178837`*^9}, {3.855151878234167*^9, 3.855151901789734*^9}, {
   3.8551519800113983`*^9, 3.8551520284676*^9}, 3.855152093425137*^9, {
   3.85515215402083*^9, 3.855152167851363*^9}, {3.8551522537749863`*^9, 
   3.8551522619847383`*^9}, {3.85697728131894*^9, 3.856977336828259*^9}, {
   3.8569774480994453`*^9, 3.8569774932466373`*^9}, {3.856978832442584*^9, 
   3.856978864005707*^9}, {3.856979223561613*^9, 3.856979267823366*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"797e8a45-3ac6-42ad-9d9f-dcac415f5695"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KSStatistic", "[", 
    RowBox[{"data_", ",", "xMin_Integer"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xMax", ",", "tail", ",", "\[Alpha]Estimator", ",", "diff"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tail", " ", "=", " ", 
       RowBox[{"SelectTail", "[", 
        RowBox[{"data", ",", "xMin"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]Estimator", " ", "=", " ", 
       RowBox[{
        RowBox[{"Estimate\[Alpha]Precise", "[", 
         RowBox[{"data", ",", "xMin"}], "]"}], "[", "\"\<Alpha\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"xMax", " ", "=", " ", 
       RowBox[{"Max", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diff", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"EmpiricalCDF", "[", 
            RowBox[{"tail", ",", "x"}], "]"}], "-", 
           RowBox[{"DiscretePowerLawDistributionCDF", "[", 
            RowBox[{"\[Alpha]Estimator", ",", "xMin", ",", "x"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "xMin", ",", "xMax"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Max", "[", "diff", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KSStatistic", "[", 
    RowBox[{"data_", ",", "xMin_Integer", ",", "xMax_Integer"}], "]"}], ":=", 
   
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tail", ",", "\[Alpha]Estimator", ",", "diff"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tail", " ", "=", " ", 
       RowBox[{"SelectTruncatedTail", "[", 
        RowBox[{"data", ",", "xMin", ",", "xMax"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]Estimator", " ", "=", " ", 
       RowBox[{
        RowBox[{"Estimate\[Alpha]Precise", "[", 
         RowBox[{"data", ",", "xMin", ",", "xMax"}], "]"}], "[", 
        "\"\<Alpha\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diff", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"EmpiricalCDF", "[", 
            RowBox[{"tail", ",", "x"}], "]"}], "-", 
           RowBox[{"DiscretePowerLawDistributionCDF", "[", 
            RowBox[{"\[Alpha]Estimator", ",", "xMin", ",", "xMax", ",", "x"}],
             "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "xMin", ",", "xMax"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Max", "[", "diff", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KSStatistic", "[", 
    RowBox[{
    "data_", ",", "xMin_Integer", ",", "xMax_Integer", ",", "alpha_"}], "]"}],
    ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tail", ",", "diff"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tail", " ", "=", " ", 
       RowBox[{"SelectTruncatedTail", "[", 
        RowBox[{"data", ",", "xMin", ",", "xMax"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"diff", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"EmpiricalCDF", "[", 
            RowBox[{"tail", ",", "x"}], "]"}], "-", 
           RowBox[{"DiscretePowerLawDistributionCDF", "[", 
            RowBox[{"alpha", ",", "xMin", ",", "xMax", ",", "x"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "xMin", ",", "xMax"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Max", "[", "diff", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KSStatistic", "[", 
    RowBox[{"data_", ",", "model_Association"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xMax", ",", "tail", ",", "\[Alpha]Estimator", ",", "diff"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tail", " ", "=", " ", 
       RowBox[{"SelectTail", "[", 
        RowBox[{"data", ",", 
         RowBox[{"model", "[", "\"\<xMin\>\"", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]Estimator", " ", "=", " ", 
       RowBox[{"model", "[", "\"\<Alpha\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xMax", " ", "=", " ", 
       RowBox[{"Max", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diff", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"EmpiricalCDF", "[", 
            RowBox[{"tail", ",", "x"}], "]"}], "-", 
           RowBox[{"DiscretePowerLawDistributionCDF", "[", 
            RowBox[{"\[Alpha]Estimator", ",", 
             RowBox[{"model", "[", "\"\<xMin\>\"", "]"}], ",", "x"}], "]"}]}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"model", "[", "\"\<xMin\>\"", "]"}], ",", "xMax"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Max", "[", "diff", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KSStatistic", "[", "data_", "]"}], ":=", 
   RowBox[{"KSStatistic", "[", 
    RowBox[{"data", ",", 
     RowBox[{"Estimate\[Alpha]AndXMin", "[", "data", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Estimate\[Alpha]AndXMin", "[", "data_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"minElement", ",", "maxElement", ",", "xMin"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"minElement", ",", "maxElement"}], "}"}], " ", "=", " ", 
       RowBox[{"MinMax", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xMin", " ", "=", " ", 
       RowBox[{
        RowBox[{"MinimalBy", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"KSStatistic", "[", 
               RowBox[{"data", ",", "x"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "minElement", ",", 
              RowBox[{"maxElement", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "Last"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Estimate\[Alpha]Precise", "[", 
       RowBox[{"data", ",", "xMin"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EstimateAll", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"smallestInterval_", " ", ":", " ", "20"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"minElement", ",", "maxElement", ",", "xMin", ",", "xMax"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"minElement", ",", "maxElement"}], "}"}], " ", "=", " ", 
       RowBox[{"MinMax", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xMin", " ", "=", " ", 
       RowBox[{
        RowBox[{"MinimalBy", "[", 
         RowBox[{
          RowBox[{"ProgressTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"KSStatistic", "[", 
               RowBox[{"data", ",", "x"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "minElement", ",", 
              RowBox[{"maxElement", "-", "1"}]}], "}"}], ",", 
            RowBox[{
            "\"\<Label\>\"", "->", 
             "\"\<Searching for \!\(\*SubscriptBox[\(x\), \(min\)]\)\>\""}]}],
            "]"}], ",", "Last"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"xMax", " ", "=", " ", 
       RowBox[{
        RowBox[{"MinimalBy", "[", 
         RowBox[{
          RowBox[{"ProgressTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"KSStatistic", "[", 
               RowBox[{"data", ",", "xMin", ",", "x"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"xMin", "+", "smallestInterval"}], ",", "maxElement"}], 
             "}"}], ",", 
            RowBox[{
            "\"\<Label\>\"", "->", 
             "\"\<Searching for \!\(\*SubscriptBox[\(x\), \(max\)]\)\>\""}]}],
            "]"}], ",", "Last"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Estimate\[Alpha]Precise", "[", 
       RowBox[{"data", ",", "xMin", ",", "xMax"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateBootstrapReplica", "[", 
    RowBox[{"data_", ",", "model_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", "bulk", ",", " ", "tail", ",", "tailProbability", ",", 
       "tailReplica", ",", "bulkReplica"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bulk", " ", "=", " ", 
       RowBox[{"SelectBulk", "[", 
        RowBox[{"data", ",", 
         RowBox[{"model", "[", "\"\<xMin\>\"", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tail", " ", "=", " ", 
       RowBox[{"SelectTail", "[", 
        RowBox[{"data", ",", 
         RowBox[{"model", "[", "\"\<xMin\>\"", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tailProbability", " ", "=", " ", 
       RowBox[{"1.0", " ", "-", " ", 
        FractionBox[
         RowBox[{"Length", "[", "bulk", "]"}], "n"]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tailReplica", " ", "=", " ", 
       RowBox[{"GeneratePowerlawSampleData", "[", 
        RowBox[{
         RowBox[{"model", "[", "\"\<Alpha\>\"", "]"}], ",", 
         RowBox[{"model", "[", "\"\<xMin\>\"", "]"}], ",", 
         RowBox[{"Max", "[", "data", "]"}], ",", 
         RowBox[{"Floor", "[", 
          RowBox[{"n", "*", "tailProbability"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bulkReplica", " ", "=", " ", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"bulk", ",", 
         RowBox[{"n", "-", 
          RowBox[{"Floor", "[", 
           RowBox[{"n", "*", "tailProbability"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RandomSample", "[", 
       RowBox[{"Join", "[", 
        RowBox[{"tailReplica", ",", " ", "bulkReplica"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateFixedMinBootstrapReplica", "[", 
    RowBox[{"model_", ",", "xMax_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"GeneratePowerlawSampleData", "[", 
    RowBox[{
     RowBox[{"model", "[", "\"\<Alpha\>\"", "]"}], ",", 
     RowBox[{"model", "[", "\"\<xMin\>\"", "]"}], ",", "xMax", ",", "n"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateGOF", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"replicas_", ":", "2000"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "model", ",", "ksOfData", ",", "syntheticKsValues", ",", "pValue"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"model", " ", "=", " ", 
       RowBox[{"Estimate\[Alpha]AndXMin", "[", "data", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ksOfData", " ", "=", " ", 
       RowBox[{"KSStatistic", "[", 
        RowBox[{"data", ",", "model"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"syntheticKsValues", " ", "=", " ", 
       RowBox[{"ProgressTable", "[", 
        RowBox[{
         RowBox[{"KSStatistic", "[", 
          RowBox[{"GenerateBootstrapReplica", "[", 
           RowBox[{"data", ",", "model"}], "]"}], "]"}], ",", "replicas"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pValue", " ", "=", " ", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"Count", "[", 
          RowBox[{"syntheticKsValues", ",", 
           RowBox[{"x_", " ", "/;", " ", 
            RowBox[{"x", ">", "ksOfData"}]}]}], "]"}], 
         RowBox[{"Length", "[", "syntheticKsValues", "]"}]], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alpha\>\"", "->", 
         RowBox[{"model", "[", "\"\<Alpha\>\"", "]"}]}], ",", 
        RowBox[{"\"\<xMin\>\"", "->", 
         RowBox[{"model", "[", "\"\<xMin\>\"", "]"}]}], ",", 
        RowBox[{"\"\<p-value\>\"", "->", "pValue"}]}], "|>"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateFixedMinGOF", "[", 
    RowBox[{"data_", ",", "xMin_", ",", 
     RowBox[{"replicas_", ":", "2000"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fixedMinModel", ",", "ksOfData", ",", "n", ",", "syntheticKsValues", 
       ",", "pValue"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fixedMinModel", " ", "=", " ", 
       RowBox[{"Estimate\[Alpha]Precise", "[", 
        RowBox[{"data", ",", "xMin"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ksOfData", " ", "=", " ", 
       RowBox[{"KSStatistic", "[", 
        RowBox[{"data", ",", "xMin"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"SelectTail", "[", 
         RowBox[{"data", ",", "xMin"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"syntheticKsValues", " ", "=", " ", 
       RowBox[{"ProgressTable", "[", 
        RowBox[{
         RowBox[{"KSStatistic", "[", 
          RowBox[{"GenerateFixedMinBootstrapReplica", "[", 
           RowBox[{"fixedMinModel", ",", 
            RowBox[{"Max", "[", "data", "]"}], ",", "n"}], "]"}], "]"}], ",", 
         "replicas"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pValue", " ", "=", " ", 
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"Count", "[", 
          RowBox[{"syntheticKsValues", ",", 
           RowBox[{"x_", " ", "/;", " ", 
            RowBox[{"x", ">", "ksOfData"}]}]}], "]"}], 
         RowBox[{"Length", "[", "syntheticKsValues", "]"}]], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alpha\>\"", "->", 
         RowBox[{"fixedMinModel", "[", "\"\<Alpha\>\"", "]"}]}], ",", 
        RowBox[{"\"\<xMin\>\"", "->", 
         RowBox[{"fixedMinModel", "[", "\"\<xMin\>\"", "]"}]}], ",", 
        RowBox[{"\"\<p-value\>\"", "->", "pValue"}]}], "|>"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.854639842812039*^9, 3.854639854454111*^9}, 
   3.8546399071368113`*^9, {3.854639962975018*^9, 3.8546399980077972`*^9}, 
   3.854640092440226*^9, {3.854641592005899*^9, 3.854641632341305*^9}, {
   3.854641945151808*^9, 3.854642038363447*^9}, {3.854645555851392*^9, 
   3.8546456216936893`*^9}, {3.854645744593898*^9, 3.854645747743281*^9}, {
   3.854645788892951*^9, 3.85464583157515*^9}, {3.854645890688324*^9, 
   3.854646166609845*^9}, {3.854646295780518*^9, 3.854646296086625*^9}, {
   3.8546464716595993`*^9, 3.854646570144018*^9}, {3.854646714048559*^9, 
   3.854646720320017*^9}, {3.854646846687818*^9, 3.8546468477321777`*^9}, {
   3.854646969835574*^9, 3.854646996054715*^9}, {3.854647185615714*^9, 
   3.854647218180624*^9}, {3.854649002631743*^9, 3.8546491797879457`*^9}, {
   3.8547209249822493`*^9, 3.854720935506174*^9}, {3.854720970020808*^9, 
   3.8547209838059387`*^9}, {3.8547212280387707`*^9, 3.854721230367402*^9}, {
   3.8547217022339287`*^9, 3.854721904070415*^9}, {3.8547219366053543`*^9, 
   3.854721964423541*^9}, {3.855151325565826*^9, 3.8551513257404757`*^9}, {
   3.855151490697371*^9, 3.855151680249939*^9}, {3.855151793910859*^9, 
   3.855151817527679*^9}, {3.855151924779797*^9, 3.8551519517731447`*^9}, {
   3.855152119288164*^9, 3.855152127550393*^9}, 3.8551523522850943`*^9, {
   3.856977488721106*^9, 3.856977488952355*^9}, {3.85698455743504*^9, 
   3.856984605269039*^9}, {3.8569886984812393`*^9, 3.856988713103656*^9}, {
   3.856988878204791*^9, 3.8569889386730413`*^9}, 3.856988984332597*^9, {
   3.856989068273157*^9, 3.8569890752731256`*^9}, {3.856989109514783*^9, 
   3.8569891196013327`*^9}, {3.856989166152072*^9, 3.85698920206849*^9}, {
   3.856989255270652*^9, 3.8569892924906397`*^9}, {3.8571631932849693`*^9, 
   3.857163199785632*^9}, {3.8571632328940077`*^9, 3.8571632430034847`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"41e6f6ee-aee7-473b-a67a-f5f9b9951d54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sample", " ", "=", " ", 
   RowBox[{"GeneratePowerlawSampleData", "[", 
    RowBox[{"2.5", ",", "1", ",", "100", ",", "2000"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.855248000760632*^9, 3.855248001760063*^9}, {
  3.8569877941032743`*^9, 3.8569878214964857`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"b7cba7ef-e555-45df-b783-3ccace02fcba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EstimateAll", "[", "sample", "]"}]], "Input",
 CellChangeTimes->{{3.8569892202802353`*^9, 3.8569892290520477`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"94c1e997-a439-4feb-9f72-9f1bd081b5fe"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Alpha\"\>", "\[Rule]", "1.71`"}], ",", 
   RowBox[{"\<\"xMin\"\>", "\[Rule]", "1"}], ",", 
   RowBox[{"\<\"xMax\"\>", "\[Rule]", "46"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.856989249913431*^9, 3.856989356622325*^9, 
  3.857150249698587*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"d57d270e-e550-4908-92b1-8037db6ee03f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Estimate\[Alpha]Precise", "[", 
  RowBox[{"sample", ",", "1", ",", "21"}], "]"}]], "Input",
 CellChangeTimes->{{3.857150269784265*^9, 3.8571502782795267`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"89d17443-768a-4837-ac0d-da17d0e39db4"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Alpha\"\>", "\[Rule]", "1.69`"}], ",", 
   RowBox[{"\<\"xMin\"\>", "\[Rule]", "1"}], ",", 
   RowBox[{"\<\"xMax\"\>", "\[Rule]", "21"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.857150279279916*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"12c51ba5-c3b2-4b06-a1e0-7352ce346168"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CalculateLogLikelihood", "[", 
  RowBox[{"sample", ",", "1.5", ",", " ", "1", ",", "21"}], "]"}]], "Input",
 CellChangeTimes->{{3.8571506181347847`*^9, 3.85715063036764*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"aa383b49-1e96-47b3-9e45-e915b3fee2f8"],

Cell[BoxData[
 RowBox[{"-", "4494.479234356629`"}]], "Output",
 CellChangeTimes->{3.857150630878723*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"a316861c-8009-4464-a58b-cabd10de09db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KSStatistic", "[", 
  RowBox[{"sample", ",", "1", ",", "21"}], "]"}]], "Input",
 CellChangeTimes->{{3.8571528763714046`*^9, 3.857152876468*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"1666932c-d2ce-4ef7-a98a-5286e4081973"],

Cell[BoxData["0.02911489730304989`"], "Output",
 CellChangeTimes->{3.857152877833331*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"57e7fadf-8590-4617-9ba2-07ff5faaf0a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tail", " ", "=", " ", 
   RowBox[{"SelectTruncatedTail", "[", 
    RowBox[{"sample", ",", "1", ",", "21"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Alpha]Estimator", " ", "=", " ", 
  RowBox[{
   RowBox[{"Estimate\[Alpha]Precise", "[", 
    RowBox[{"sample", ",", "1", ",", "21"}], "]"}], "[", "\"\<Alpha\>\"", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.857152943510116*^9, 3.857152966923877*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"e171c222-a874-4bcf-aff0-e8d55f191ced"],

Cell[BoxData["1.69`"], "Output",
 CellChangeTimes->{3.857152968069912*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"1ee15afb-c0a6-4a18-921e-7255d9c3c90f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"diff", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"EmpiricalCDF", "[", 
        RowBox[{"tail", ",", "x"}], "]"}], "-", 
       RowBox[{"DiscretePowerLawDistributionCDF", "[", 
        RowBox[{"\[Alpha]Estimator", ",", "1", ",", "21", ",", "x"}], "]"}]}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "21"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", "diff", "]"}]}], "Input",
 CellChangeTimes->{{3.857152943510116*^9, 
  3.857152982759717*^9}},ExpressionUUID->"3e9a34b0-c7c7-486f-b7e6-\
15521c838548"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ProgressTable", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"KSStatistic", "[", 
      RowBox[{"sample", ",", "1", ",", "x"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"1", "+", "20"}], ",", "93"}], "}"}], ",", 
   RowBox[{
   "\"\<Label\>\"", "->", 
    "\"\<Searching for \!\(\*SubscriptBox[\(x\), \(max\)]\)\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857152755238266*^9, 3.857152785367694*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"d934c4a7-067f-4243-9897-93f8b7230660"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"21", ",", "0.02911489730304989`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"22", ",", "0.029077579758387817`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"23", ",", "0.029582568021723488`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"24", ",", "0.029988556450082027`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "0.02741152550930115`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"26", ",", "0.027844547283316923`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"27", ",", "0.027778729067781893`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"28", ",", "0.02786678711507473`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"29", ",", "0.027048546589212574`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"30", ",", "0.026611048549375682`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"31", ",", "0.02999393868473227`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"32", ",", "0.026664410270932082`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"33", ",", "0.027157391868900704`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"34", ",", "0.027613970471152716`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"35", ",", "0.0243451971881663`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"36", ",", "0.024305532750634573`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"37", ",", "0.02733024436922077`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"38", ",", "0.0276685993870866`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"39", ",", "0.02445021066859182`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"40", ",", "0.024730010720734108`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "0.02478109796037986`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"42", ",", "0.024813181742127988`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"43", ",", "0.025034732217857514`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"44", ",", "0.024825314190244085`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"45", ",", "0.02418883812470024`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"46", ",", "0.02395190299303085`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"47", ",", "0.027111269902477586`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"48", ",", "0.02665465634110792`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"49", ",", "0.026391196403634798`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "0.026116919906458813`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"51", ",", "0.026035310121457433`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"52", ",", "0.029417594720805795`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"53", ",", "0.029122115317572084`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"54", ",", "0.028616687827168863`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"55", ",", "0.028304857779926196`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"56", ",", "0.02838626208227335`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"57", ",", "0.028459202790272864`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"58", ",", "0.03146601538312149`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"59", ",", "0.0315305096795524`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"60", ",", "0.031189317600220257`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"61", ",", "0.03044546808048032`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"62", ",", "0.03408094149152413`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"63", ",", "0.030329115204734414`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"64", ",", "0.033964868082871136`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"65", ",", "0.03360236529416011`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"66", ",", "0.033235221572299245`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"67", ",", "0.03305975542511913`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"68", ",", "0.032683596669708714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"69", ",", "0.03654667424123248`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"70", ",", "0.036167657470699555`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"71", ",", "0.036174365062801916`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"72", ",", "0.03617642955326117`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"73", ",", "0.03520306320937977`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"74", ",", "0.03500347010375765`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"75", ",", "0.03480017247972017`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"76", ",", "0.034979557265990946`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"77", ",", "0.03476872888770355`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"78", ",", "0.03847530183281839`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"79", ",", "0.03807070487160963`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"80", ",", "0.03823944983016375`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"81", ",", "0.03821260632094364`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"82", ",", "0.03818248360180376`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"83", ",", "0.03776608200165593`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"84", ",", "0.037730013166876075`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"85", ",", "0.037690985395684384`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"86", ",", "0.03745817406849289`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"87", ",", "0.03760443944835251`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"88", ",", "0.037557104225259375`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"89", ",", "0.03769781816652584`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"90", ",", "0.03783588167654384`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"91", ",", "0.03759023023216318`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"92", ",", "0.03753286472527767`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"93", ",", "0.037473215981916275`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8571528450162373`*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"1d7be67e-4856-470d-b2fd-261264678925"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ksValues", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xMin", ",", "xMax", ",", 
       RowBox[{"KSStatistic", "[", 
        RowBox[{"sample", ",", "xMin", ",", "xMax"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xMin", ",", "1", ",", "50"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xMax", ",", 
       RowBox[{"xMin", "+", "1"}], ",", "50"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.856984659582404*^9, 3.8569847385069513`*^9}, {
  3.856984799520306*^9, 3.856984818144414*^9}, {3.8569848687196407`*^9, 
  3.856984923562539*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"a1a10229-7ffc-4ff1-b40a-464cd41dc7ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ksValues", " ", "=", " ", 
   RowBox[{"ProgressTable", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xMin", ",", 
       RowBox[{"KSStatistic", "[", 
        RowBox[{"sample", ",", "xMin"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xMin", ",", "1", ",", "50"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.856987613193267*^9, 3.856987626186286*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"22707f06-484d-460f-80dd-3aca447b9179"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"ksValues", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"GridLines", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellLabel->
  "In[155]:=",ExpressionUUID->"a64961a6-31b5-4dfc-b064-ee89eab97773"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJw10GtIk1Ecx/GHIjQoWOkLibK0zFCTpbVLVvvp5uZKKRY1w0kibY1B9WZ0
MS/rRWCJQ4yWQazpSkLQttxsluIVWWprbavW2k3qxSwKkyQ0iIr+z4HD4XO+
55wXJ6P2gkK9imGYgr/z3/p/LIi8r34OJb7oRbQBhuuc4382kZNRM6nUDyxY
yRx0VEz8fnOmk5yKykR3/bGHPeQ0jFqa7nQsO8mb8UhZlSM32sjbkNCHzCOX
XORMdGu3hv1ZdvIOpF5bPn/9Bnt/J+L+cl/oyCB5FyqbNV1NSWPkHEg1QoXi
Pus8jJ7jDL9Nnybn48dqx1KwgTUX6YFxj07tJe8Bw2szVjXOkAugXSevDgy5
yYXIT3PcbO94Qd6L6PiVwGzuLHkfQvxsT+TbSzIP2taplbou9n0+4g3l3j7/
a7IA0uGipqTvfrIQupPPvvZofOT9EBbyp588Zl2ECkY6Y8p+Rz6A6rvVrhNr
WR9EWssDWSsvTj4Ex3r7veY1rEWon1BxdZYYGVgMNG5R1JINQF3nkkT2KUq9
GMlyTpbVSDYUI7qpP3d3HttLUBO3HY4NRaiXYKP58lEryIwYbpeh9/jTMHUx
Lq70nzWXkRkJ2jPtvRH3B+oSLFpOjX3kk5lSWHQtKt3tEPVS2NxTqpS599Sl
CHvTYy1CskGKkFkg8FwNUpdhTJnyfMM8/Y9BhtOxDKdphf2vMgwOZN1Sb6fz
hjIYJ3+JuTXsfTnmOS7fSFtQ9AdnzPDN
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{{0., 5., 10., 15., 20., 25., 30., 35., 40., 45., 50.}, {0., 
   0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 50.}, {0, 0.5066591643593226}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.856987636087669*^9, {3.856987802893752*^9, 3.856987835369301*^9}},
 CellLabel->
  "Out[155]=",ExpressionUUID->"8c485a07-f213-4b37-b19a-b941aa718094"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ksValues", " ", "=", " ", 
   RowBox[{"ProgressTable", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xMax", ",", 
       RowBox[{"KSStatistic", "[", 
        RowBox[{"sample", ",", "1", ",", "xMax"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xMax", ",", "2", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.856985688661845*^9, 3.856985730714253*^9}, {
  3.856985791449235*^9, 3.856985791843234*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"8e76a66f-2095-4e0b-aa20-a05eab1980c8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"ksValues", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"GridLines", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.856985718561245*^9, 3.856985722261689*^9}, {
  3.856985766970598*^9, 3.85698576874133*^9}, {3.8569860679233017`*^9, 
  3.8569860733356*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"2440f560-8c2b-4f5d-a847-a7e7ba9318e7"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJw9kgtMU1cYx+8QO8TIYLiJC9HCGMNNpSKIvP/IgL6AtrSlhDF5OFO2bFZ8
dXMhd4IEIkrdXFJBR8UtYHRrgWlVMlJ5uMUNvKvgI3ukCcMxtzqCQ8p8bCw7
325yc/PL//ud7zv3nIiKbZrX/TiOq5x///2yB5zrSu/EeyEZ/2EAhI5Hn9n7
P2QcDHPfi6dn444wXgpJ1SeRlsMfMA6D6qm0BJGY6sPh8KV1jVz9iLEYZTFj
YTsHyI+E5H55inXrUcZR8CQYS0ONrYyjwT9sXmX2b2McA4lDJEw8cYzxSwje
fiCy5BLVr8ZUWku+Zuw447UwyWdnHGfIl0Cc9Jd80avE62B7emix5f/14yCR
WW93H7MxXo/g89bR+0eJ42Fcf7eE20ecANOo73OFQP02QLiwzVB7mTgRwaYv
G36Wf8x4I8Ta0T/VZ4mTULaxQj8YQvtJhuWU8EduLXEKxLv33hNVE6fCE5H4
VngjcRqEFQtTj3fT/tNh2+pN9WYQZ8DUcSe69xz1A6acGumdPJbz89xjd75w
leozIZQbJNdz2Pp8JlwH79VPe60s3wRhx3NdTeOM+Xk+/WTHrofkZ8Gxby47
Rkd+FoL7R354ZxGd7yuwjS/3ujWM+XmeW6dLLKM8G1zJayabkfJsCC83m75o
pzwHjt1p7SNvUp4D1d9d1TODNF8uuGExd6ue5suFS6KvDxqg+aSw2J85W6Kg
/Ush/OhOUIgolwEVe69t6WthuQyu2CXPcqcYc3KofvUr/XQl+5+8HJY36kIl
bjpvBTwniqu68hjzCtiUd29NP6DzUsKTFDcsC6FcCUuz/5Axivw8NAQuyFGF
s/vF5wF93xYNRtF9ywdXWnBm2RS7r3w+PNKfLoetoftbAN9senvQjhMsL4Bj
iX2PNYhyFVSPMr+/UclyqGCoWiDVxlO9Cjcndz6I92fsUuHr7ouqBC/1V8M8
1Lb/l17GUMNxUDaRfq6d+WpIJ/3jD9cxdqnh8X6TXb2fMaeBa1f7AScxNLi5
zHglUkS+Bp1r7YfmfqP+GoSJtyzUfseYK8T5a77VNyZp/kJMBT6ejh+m+QsR
4Iq+HdBzkvmFiPE6PVwNY04L6WKP/8ojjKFFjN+4ssXCmNfCtLynqaOJfC06
L0jeDtWTr0NZ+qZVxWrydfB8ldmaoiRfB3NE7CXnGvJ1sP6e3DoO8vUQN/Yr
7cnk6yH0F3jEeeTrYQsYq0vaTL4enUsfu0UZ5BfBvDlw5v1E8ovQcCj1XUcs
+UXwybTXa6ifqwidFwNqOJqXM8AgNLYmlpNvgHTDQFb0dvINMMsr94zw5Bvg
G3U/H0f/hyuGtXZFVGHbyYx/AA7axDc=
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{{0., 10., 20., 30., 40., 50., 60., 70., 80., 90., 100.}, {0., 
    0.0025, 0.005, 0.0075, 0.01, 0.0125, 0.015, 0.0175, 0.02, 0.0225, 0.025, 
    0.0275, 0.03, 0.0325, 0.035, 0.0375, 0.04}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 100.}, {0, 0.03847530183281839}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.856985764541472*^9, 3.856985769087985*^9}, 
   3.856985865298348*^9, {3.856986070862797*^9, 3.8569860736731358`*^9}},
 CellLabel->
  "Out[137]=",ExpressionUUID->"15fcc536-25c6-4f91-a905-29c254ec79fe"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"model", " ", "=", " ", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<Alpha\>\"", "\[Rule]", "1.71`"}], ",", 
     RowBox[{"\"\<xMin\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<xMax\>\"", "\[Rule]", "46"}]}], "\[RightAssociation]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.857161267105235*^9, 3.857161270109729*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"18ac679a-bedf-4922-bd97-91ca0b1aac8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cutSample", "=", 
   RowBox[{"SelectTruncatedTail", "[", 
    RowBox[{"sample", ",", "1", ",", "46"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8571612887328253`*^9, 3.857161350997081*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"70c7ca92-423f-46bb-92ca-2aa837641d48"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"KSStatistic", "[", 
  RowBox[{"cutSample", ",", "1", ",", "46", ",", "1.71"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HistogramPointPlots", "[", 
    RowBox[{"cutSample", ",", "\[IndentingNewLine]", 
     RowBox[{"ScalingFunctions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.9", ",", 
          RowBox[{
           RowBox[{"Max", "[", "sample", "]"}], "+", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DiscretePowerLawDistributionPDF", "[", 
      RowBox[{"1.71", ",", "1", ",", "46", ",", "x"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "46"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ScalingFunctions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", "\"\<Fit\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Dashed", ",", "Black"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.855247815059552*^9, 3.85524781653443*^9}, {
  3.855247936680771*^9, 3.855247992917775*^9}, {3.857161354120371*^9, 
  3.8571614270039988`*^9}, {3.8571632570970182`*^9, 3.857163271669425*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"503e7c37-346b-4530-8d22-9026120f9053"],

Cell[BoxData["0.02395190299303085`"], "Output",
 CellChangeTimes->{
  3.8552478175867157`*^9, {3.855247918646122*^9, 3.855247937846774*^9}, {
   3.855247970870625*^9, 3.8552480241992493`*^9}, 3.855248823985374*^9, 
   3.856970295177355*^9, 3.857161274545063*^9, {3.857161356917444*^9, 
   3.857161374351056*^9}, 3.857161430657358*^9, 3.857163273169958*^9, 
   3.857485459752157*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"ef0069cf-4a50-47f3-9188-ef2b00dba2a1"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{}, {{{
         Directive[
          CapForm["Butt"], 
          AbsoluteThickness[1.6], 
          AbsoluteDashing[{}], FontSize -> 14, 
          PointSize[Large], 
          RGBColor[0.689993, 0.089999, 0.119999]], 
         PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBWIQDQP5r8ouqZ1+vP+95a9/TnrP7BkYHsw5fJ/hADfz
2qpXkz/ac30ul9KQYzkAkf9mLxnZ17lyNccB49633x0P/LQ/+PPdLZ/JvAeY
FLR+ca/+Yy94oKtsRQ3fgfAoo3VFSv/tpeaflay6x3OgeLW1/aZFDA7lTu86
l3AJQs1ndDjQ/iXsZofAAbHQrbs3ZjM5ZM8/7rPnisABH/P67Y/1mB1WChy+
c3G/4IHaeZf3iD1kdph892py9RvhA4E9htosrSwOM9P4FJjVRQ4s331d7JQM
q8MBH85/sluFD8h7+FqKrULwIe5nc9B9UPR6m6Xogar6XwezV7E5iF9fuGht
t+iBtonZVtXy7A5uTKlPdJeLHNDZzMJm1sfucEFl62HnTWIHJj4urnb6juBv
XJc/RS+awyFUrpGpLFDiwImjtuUluzgcDvDXh87ZLH7gw+aLf2tFOR1uifs6
rvggeeCnzqSa5TkIPiT8OB3ClnEzWtbIHzgr9eHVFAEuh8mpCUl24tIHJrQw
77gfy+XA6SzQrMEjeUDZa9q1qBVccP3y/86etvjA5TDnQu7D+1riB2Zf4/65
zJQb7p4o7Yke5yq44fqzT+zYd3knt4NEvM7Cgm0yBy7uuPrlxg9uuP3feHc2
/jHlgfOPfuYPjipE8CHxywN3397jVu80HvPA7VvhePjoMUleuHreIiPry00I
vt+aPtfUrbxw+3Vt9UL2P0PwBd+IiH0Q44Ordw75Y8bqxge3b8nJxWXcJXxw
/+Q4TdjLtxAhDwB1PzKT
          "]]}}}, {{}, {}}}, {{{{}, {}, 
        TagBox[{
          Directive[
           Opacity[1.], 
           AbsoluteThickness[1.6], 
           Dashing[{Small, Small}], 
           GrayLevel[0]], 
          LineBox[CompressedData["
1:eJwB4QQe+yFib1JlAgAAAE0AAAACAAAAQbj97m75dD4pEHxmtz/lv9XRqeds
PVM/m7bdWypQ5b/a88v0Qj1jPwtdP1GdYOW/3ARd+y09cz/uqQI8g4Hlv12N
pX4jPYM/tEOJEU/D5b+e0UlAHj2TPz93lrzmRua/vvMboRs9oz9V3rASFk7n
v84EhVEaPbM/g6zlvnRc6b8lloeNPAzEP2TiIha/0e2/8qNZkwHJzT8Hn5fl
s/3wv7It51JwqtM/CXPbiRQI87/SjQhO8dfYP88Tia27PvW/+mqwGf2s3T95
Rx4Akk/3v0SmnyvNdOE/5kcd0q6M+b91wY9N4gbkP4Pu2e1Xv/u/KRvD17xs
5j8BKH44MMz9vxH36RpgBuk/IhdGgacCAMB9EVTGyHPrP7XjwH1ODAHAUtbm
9PfU7T9ggxqfuxACwK6ONu73NPA/bAkpAEwrA8B1URuWVmnxP+tYq/jzMgTA
VtV5mpm38j/LjuIwv1AFwGuubOC///M/wpf4jVBpBsDCJoHayDH1PytqgoL5
bgfAM2APMbZ99j/2IsG2xYoIwOY4vzuGs/c/M6VzgqmTCcCz0uiiOgP5P9IN
242wsgrAtMGmS9JM+j+HSSG+fcwLwPdPhqhMgPs/r07bhWLTDMBUn99hq838
Pzg6So1q8A3A841az+wE/j8z7ywsivoOwMfRaX4RNv8/RXfu72//D8Baa/lE
jUAAQNxysnk8jRDAcb3OJAPbAEDPjifHTBERwBXw4DJrggFA8h13tG6gEcBT
Tb3hxCYCQKEWNrTzLBLAMnqq6g/AAkAI9K5/BLASwJ6H1CFNZgNAoUQC6yY+
E8CrZA+zewEEQPJ5DyLVwhPAU2wU5ZuZBEDQGIxr5kQUwIhUVkWuPgVA3yrj
VAnSFMBdDKn/sdgFQKUh9Am4VRXAv6Q46Kd/BkCdi99eeOQVwMIM2SqPGwdA
TtqEf8RpFsBgn0MOaLQHQIqSmbJz7BbAixLrHzNaCED4vYiFNHoXwFdVo4vv
9AhAH84xJIH+F8CveJglnpwJQHZRtWLfjRjAosZXYD5BCkBZPqizoBoZwDbk
J/XP2gpA9Q9V0O2dGcBX4jS4U4ELQMJU3IxMLBrAGbBS1cgcDEBIfh0VN7Ea
wHWoOpMvtQxAWBHOr4QzG8BegV9/iFoNQJsXWerjwBvA6CmVxdL0DUCWAp7w
zkQcwGwjS7WD9w1A9o4C+xtHHMDwHAGlNPoNQFYbZwVpSRzA+Q9thJb/DUAX
NDAaA04cwAr2RENaCg5AmWXCQzdXHMArwvTA4R8OQJzI5pafaRzAblpUvPBK
DkCiji89cI4cwPJTCqyhTQ5AAhuUR72QHMB2TcCbUlAOQGKn+FEKkxzAf0As
e7RVDkAkwMFmpJccwJAmBDp4YA5ApvFTkNigHMCy8rO3/3UOQKlUeONAsxzA
Nuxpp7B4DkAJ4dztjbUcwLrlH5dhew5AaW1B+Nq3HMDD2It2w4AOQCuGCg11
vBzA1L5jNYeLDkCst5w2qcUcwFi4GSU4jg5ADEQBQfbHHMDcsc8U6ZAOQG3Q
ZUtDyhzA5KQ79EqWDkAt6S5g3c4cwGie8eP7mA5AjXWTairRHMDsl6fTrJsO
QO4B+HR30xzAcJFdw12eDkBOjlx/xNUcwPWKE7MOoQ5ArxrBiRHYHMCQxlQP

           "]]}, Annotation[#, "Charting`Private`Tag$8549#1"]& ]}}, {}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, 
     AxesOrigin -> {-0.10536051565782628`, -6.566657500041587}, AxesStyle -> 
     GrayLevel[0], BaseStyle -> (FontSize -> 14), DisplayFunction :> Identity,
      Frame -> {{True, True}, {True, True}}, 
     FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> GrayLevel[0], 
     FrameTicks -> {{Quiet[
         Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
        Charting`ScaledFrameTicks[{Log, Exp}]}, {Quiet[
         Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
        Charting`ScaledFrameTicks[{Log, Exp}]}}, FrameTicksStyle -> 
     GrayLevel[0], 
     GridLines -> {{0., 0.6931471805599453, 1.6094379124341003`, 
       2.302585092994046, 2.995732273553991, 
       3.912023005428146}, {-1.606941032235513, -0.9150415124737231, \
-0.5099926374620988, -0.22251874654536768`}}, GridLinesStyle -> Directive[
       GrayLevel[0.5], 
       Opacity[0.3]], ImageSize -> 500, 
     LabelStyle -> {FontFamily -> "Helvetica", 
       GrayLevel[0]}, 
     Method -> {
      "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Exp[
            Part[#, 1]], 
           Exp[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Exp[
            Part[#, 1]], 
           Exp[
            Part[#, 2]]}& )}}, PlotRange -> NCache[{{-0.10536051565782628`, 
         Log[94]}, {-6.566657500041587, 0}}, {{-0.10536051565782628`, 
        4.543294782270004}, {-6.566657500041587, 0}}], PlotRangeClipping -> 
     True, PlotRangePadding -> {{0, 0}, {
        Scaled[0.02], 0}}, Ticks -> {Quiet[
        Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , Quiet[
        Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& }, TicksStyle -> 
     GrayLevel[0]}], 
   FormBox[
    FormBox[
     TemplateBox[{"\"Fit\""}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    Dashing[{Small, Small}], 
                    GrayLevel[0]], {
                    LineBox[{{0, 10}, {40, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    Dashing[{Small, Small}], 
                    GrayLevel[0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {40, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{"Directive", "[", 
               RowBox[{
                 RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                 RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                 RowBox[{"Dashing", "[", 
                   RowBox[{"{", 
                    RowBox[{"Small", ",", "Small"}], "}"}], "]"}], ",", 
                 InterpretationBox[
                  ButtonBox[
                   TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> GrayLevel[0.], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"GrayLevel", "[", "0", "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                   BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                   ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                   Automatic, Method -> "Preemptive"], 
                  GrayLevel[0], Editable -> False, Selectable -> False]}], 
               "]"}], "}"}], ",", 
           RowBox[{"{", #, "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.8552478175867157`*^9, {3.855247918646122*^9, 3.855247937846774*^9}, {
   3.855247970870625*^9, 3.8552480241992493`*^9}, 3.855248823985374*^9, 
   3.856970295177355*^9, 3.857161274545063*^9, {3.857161356917444*^9, 
   3.857161374351056*^9}, 3.857161430657358*^9, 3.857163273169958*^9, 
   3.8574854600799007`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"6960f234-5b92-49b1-a1e8-a6ea19fc48ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"synthSample", " ", "=", " ", 
   RowBox[{"GeneratePowerlawSampleData", "[", 
    RowBox[{"1.71", ",", "1", ",", "46", ",", 
     RowBox[{"Length", "[", "sample", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"KSStatistic", "[", 
  RowBox[{"synthSample", ",", "1", ",", "46", ",", "1.71"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HistogramPointPlots", "[", 
    RowBox[{"synthSample", ",", "\[IndentingNewLine]", 
     RowBox[{"ScalingFunctions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.9", ",", 
          RowBox[{
           RowBox[{"Max", "[", "sample", "]"}], "+", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DiscretePowerLawDistributionPDF", "[", 
      RowBox[{"1.71", ",", "1", ",", "46", ",", "x"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "46"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ScalingFunctions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", "\"\<Fit\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Dashed", ",", "Black"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{
  3.8571630985109873`*^9, {3.8571632829825783`*^9, 3.857163291071525*^9}, {
   3.857163323335226*^9, 3.85716333361657*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"c2950aad-5c3f-48b5-b3f2-3109b1c07326"],

Cell[BoxData["0.020094875146834557`"], "Output",
 CellChangeTimes->{{3.857163104034308*^9, 3.857163133084931*^9}, {
  3.857163334957078*^9, 3.857163415947462*^9}, {3.857485481369796*^9, 
  3.857485521048493*^9}},
 CellLabel->
  "Out[116]=",ExpressionUUID->"bfc84366-5471-4f19-90e5-4a03ecdc7168"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{}, {{{
         Directive[
          CapForm["Butt"], 
          AbsoluteThickness[1.6], 
          AbsoluteDashing[{}], FontSize -> 14, 
          PointSize[Large], 
          RGBColor[0.689993, 0.089999, 0.119999]], 
         PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBWIQDQMf2gVev2h9tv+95a9/TnrP7OsW8P0VTf27n5t5
bdWryR/t590NKLuZy3IAIv/N/mQSt27SfdYDxr1vvzse+Gmf2MVxI56V+wCT
gtYv7tV/7JetSr4UeYbvQHiU0boipf/2Jip6zzbF8R8oXm1tv2kRg8NWkS2/
pvwROAAxn9FhPvfjjd1+ggfEQrfu3pjN5LDHIrL4upvwAR/z+u2P9ZgdJsoI
en7VFjpQO+/yHrGHzA6Pb/86e9tP5EBgj6E2SyuLwwpH/g1BksIHlu++LnZK
htVhxb8q/Q89IgfkPXwtxVYh+BD3szkk+vQFtG0WPVBV/+tg9io2B67WbObS
2+IH2iZmW1XLszs8c43q3xEkfkBnMwubWR+7w/zJuRv8KiUOTHxcXO30nd3h
jG3P4jWiogc2rsufohfN4RC8448Bo4nkgRNHbctLdnE4SM9aWChzS+zAh80X
/9aKcsLN/6kzqWZ5DqeDaKHsRYs8MWj4cTqo9Fq+b5CQOnBW6sOrKQJccPUT
Wph33I/lgpun7DXtWtQKLoekKxL+nvdkDsj/O3va4gOXwwLpH+sEl8gfmH2N
++cyU26Hu7d8BMTtpQ9EaU/0OFfBDTc/+8SOfZd3csP1X9xx9cuNHwj+N96d
jX9MeeD+OfqZPziqEMGHxC8P3Py9x63eaTzmgdu/wvHw0WOSvHD7rvF2ZPz0
44XL8xYZWV9uQvD91vS5pm7lhdsv+EZE7IMYH1y/c8gfM1Y3Prh9S04uLuMu
4YOHT47ThL18CxHyACFyPx8=
          "]]}}}, {{}, {}}}, {{{{}, {}, 
        TagBox[{
          Directive[
           Opacity[1.], 
           AbsoluteThickness[1.6], 
           Dashing[{Small, Small}], 
           GrayLevel[0]], 
          LineBox[CompressedData["
1:eJwB4QQe+yFib1JlAgAAAE0AAAACAAAAQbj97m75dD4pEHxmtz/lv9XRqeds
PVM/m7bdWypQ5b/a88v0Qj1jPwtdP1GdYOW/3ARd+y09cz/uqQI8g4Hlv12N
pX4jPYM/tEOJEU/D5b+e0UlAHj2TPz93lrzmRua/vvMboRs9oz9V3rASFk7n
v84EhVEaPbM/g6zlvnRc6b8lloeNPAzEP2TiIha/0e2/8qNZkwHJzT8Hn5fl
s/3wv7It51JwqtM/CXPbiRQI87/SjQhO8dfYP88Tia27PvW/+mqwGf2s3T95
Rx4Akk/3v0SmnyvNdOE/5kcd0q6M+b91wY9N4gbkP4Pu2e1Xv/u/KRvD17xs
5j8BKH44MMz9vxH36RpgBuk/IhdGgacCAMB9EVTGyHPrP7XjwH1ODAHAUtbm
9PfU7T9ggxqfuxACwK6ONu73NPA/bAkpAEwrA8B1URuWVmnxP+tYq/jzMgTA
VtV5mpm38j/LjuIwv1AFwGuubOC///M/wpf4jVBpBsDCJoHayDH1PytqgoL5
bgfAM2APMbZ99j/2IsG2xYoIwOY4vzuGs/c/M6VzgqmTCcCz0uiiOgP5P9IN
242wsgrAtMGmS9JM+j+HSSG+fcwLwPdPhqhMgPs/r07bhWLTDMBUn99hq838
Pzg6So1q8A3A841az+wE/j8z7ywsivoOwMfRaX4RNv8/RXfu72//D8Baa/lE
jUAAQNxysnk8jRDAcb3OJAPbAEDPjifHTBERwBXw4DJrggFA8h13tG6gEcBT
Tb3hxCYCQKEWNrTzLBLAMnqq6g/AAkAI9K5/BLASwJ6H1CFNZgNAoUQC6yY+
E8CrZA+zewEEQPJ5DyLVwhPAU2wU5ZuZBEDQGIxr5kQUwIhUVkWuPgVA3yrj
VAnSFMBdDKn/sdgFQKUh9Am4VRXAv6Q46Kd/BkCdi99eeOQVwMIM2SqPGwdA
TtqEf8RpFsBgn0MOaLQHQIqSmbJz7BbAixLrHzNaCED4vYiFNHoXwFdVo4vv
9AhAH84xJIH+F8CveJglnpwJQHZRtWLfjRjAosZXYD5BCkBZPqizoBoZwDbk
J/XP2gpA9Q9V0O2dGcBX4jS4U4ELQMJU3IxMLBrAGbBS1cgcDEBIfh0VN7Ea
wHWoOpMvtQxAWBHOr4QzG8BegV9/iFoNQJsXWerjwBvA6CmVxdL0DUCWAp7w
zkQcwGwjS7WD9w1A9o4C+xtHHMDwHAGlNPoNQFYbZwVpSRzA+Q9thJb/DUAX
NDAaA04cwAr2RENaCg5AmWXCQzdXHMArwvTA4R8OQJzI5pafaRzAblpUvPBK
DkCiji89cI4cwPJTCqyhTQ5AAhuUR72QHMB2TcCbUlAOQGKn+FEKkxzAf0As
e7RVDkAkwMFmpJccwJAmBDp4YA5ApvFTkNigHMCy8rO3/3UOQKlUeONAsxzA
Nuxpp7B4DkAJ4dztjbUcwLrlH5dhew5AaW1B+Nq3HMDD2It2w4AOQCuGCg11
vBzA1L5jNYeLDkCst5w2qcUcwFi4GSU4jg5ADEQBQfbHHMDcsc8U6ZAOQG3Q
ZUtDyhzA5KQ79EqWDkAt6S5g3c4cwGie8eP7mA5AjXWTairRHMDsl6fTrJsO
QO4B+HR30xzAcJFdw12eDkBOjlx/xNUcwPWKE7MOoQ5ArxrBiRHYHMCQxlQP

           "]]}, Annotation[#, "Charting`Private`Tag$45199#1"]& ]}}, {}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, 
     AxesOrigin -> {-0.10536051565782628`, -6.566657500041587}, AxesStyle -> 
     GrayLevel[0], BaseStyle -> (FontSize -> 14), DisplayFunction :> Identity,
      Frame -> {{True, True}, {True, True}}, 
     FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> GrayLevel[0], 
     FrameTicks -> {{Quiet[
         Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
        Charting`ScaledFrameTicks[{Log, Exp}]}, {Quiet[
         Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
        Charting`ScaledFrameTicks[{Log, Exp}]}}, FrameTicksStyle -> 
     GrayLevel[0], 
     GridLines -> {{0., 0.6931471805599453, 1.6094379124341003`, 
       2.302585092994046, 2.995732273553991, 
       3.912023005428146}, {-1.606941032235513, -0.9150415124737231, \
-0.5099926374620988, -0.22251874654536768`}}, GridLinesStyle -> Directive[
       GrayLevel[0.5], 
       Opacity[0.3]], ImageSize -> 500, 
     LabelStyle -> {FontFamily -> "Helvetica", 
       GrayLevel[0]}, 
     Method -> {
      "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Exp[
            Part[#, 1]], 
           Exp[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Exp[
            Part[#, 1]], 
           Exp[
            Part[#, 2]]}& )}}, PlotRange -> NCache[{{-0.10536051565782628`, 
         Log[94]}, {-6.566657500041587, 0}}, {{-0.10536051565782628`, 
        4.543294782270004}, {-6.566657500041587, 0}}], PlotRangeClipping -> 
     True, PlotRangePadding -> {{0, 0}, {
        Scaled[0.02], 0}}, Ticks -> {Quiet[
        Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , Quiet[
        Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& }, TicksStyle -> 
     GrayLevel[0]}], 
   FormBox[
    FormBox[
     TemplateBox[{"\"Fit\""}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    Dashing[{Small, Small}], 
                    GrayLevel[0]], {
                    LineBox[{{0, 10}, {40, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    Dashing[{Small, Small}], 
                    GrayLevel[0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {40, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{"Directive", "[", 
               RowBox[{
                 RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                 RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                 RowBox[{"Dashing", "[", 
                   RowBox[{"{", 
                    RowBox[{"Small", ",", "Small"}], "}"}], "]"}], ",", 
                 InterpretationBox[
                  ButtonBox[
                   TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> GrayLevel[0.], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"GrayLevel", "[", "0", "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                   BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                   ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                   Automatic, Method -> "Preemptive"], 
                  GrayLevel[0], Editable -> False, Selectable -> False]}], 
               "]"}], "}"}], ",", 
           RowBox[{"{", #, "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.857163104034308*^9, 3.857163133084931*^9}, {
  3.857163334957078*^9, 3.857163415947462*^9}, {3.857485481369796*^9, 
  3.857485521138563*^9}},
 CellLabel->
  "Out[117]=",ExpressionUUID->"350cf701-b7cf-4a0b-b5ad-b58831d7642a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 832},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>0.9 Inherited,
FrontEndVersion->"12.3 para Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a6e4e336-7221-4bb1-9d45-8dcff3224744"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 170, 3, 117, "Title",ExpressionUUID->"d598f596-2801-4778-8c27-dca3abeee197"],
Cell[CellGroupData[{
Cell[775, 29, 209, 4, 83, "Chapter",ExpressionUUID->"0b871386-a10f-4f47-bdb9-df266cbf560a"],
Cell[987, 35, 553, 18, 41, "Text",ExpressionUUID->"89e4dd4a-9755-4f11-a6a0-b742854b9312"],
Cell[CellGroupData[{
Cell[1565, 57, 501, 14, 80, "Input",ExpressionUUID->"36148f69-bb5e-44bf-a19e-87e6abe82f0d"],
Cell[2069, 73, 552, 16, 57, "Output",ExpressionUUID->"27c0ba0c-1fd0-40e1-bf25-7fb77384b5c6"]
}, Open  ]],
Cell[2636, 92, 174, 3, 41, "Text",ExpressionUUID->"d030ddc0-840c-406f-9fed-a6c33bd48ea1"],
Cell[2813, 97, 589, 15, 56, "Input",ExpressionUUID->"2d935fb8-71fe-4cc1-96ea-a6df538f29de"],
Cell[3405, 114, 198, 3, 41, "Text",ExpressionUUID->"17b93fbd-3e47-4383-a4b6-b997a08de08f"],
Cell[CellGroupData[{
Cell[3628, 121, 345, 8, 63, "Input",ExpressionUUID->"2d293e8d-5a45-4bbc-b068-e3ae5b31ba38"],
Cell[3976, 131, 594, 16, 58, "Output",ExpressionUUID->"880ea395-337c-43dd-8736-2631998247b3"]
}, Open  ]],
Cell[4585, 150, 792, 20, 56, "Input",ExpressionUUID->"aa3cbd4b-3d23-4651-910b-7ca458849cd0"],
Cell[5380, 172, 261, 4, 41, "Text",ExpressionUUID->"a8c6d9c9-a6f0-4eb2-ad19-16292a5a4ed4"],
Cell[CellGroupData[{
Cell[5666, 180, 1001, 24, 73, "Input",ExpressionUUID->"34b524a6-4d94-4956-a171-e4721cbc54a9"],
Cell[6670, 206, 960, 24, 38, "Output",ExpressionUUID->"3f40652f-55b0-4c64-8522-ec75a6d4ea5a"]
}, Open  ]],
Cell[7645, 233, 230, 4, 41, "Text",ExpressionUUID->"a405a4a4-ebbf-4507-afff-4b6561fbc8ee"],
Cell[7878, 239, 723, 21, 78, "Input",ExpressionUUID->"0cb40b13-d6ef-4865-9fd1-28fd0f55796b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8638, 265, 161, 3, 83, "Chapter",ExpressionUUID->"f8d96c95-45f2-4141-baff-f3921e54f11f"],
Cell[8802, 270, 441, 10, 72, "Input",ExpressionUUID->"ea06bf2b-47a9-4df9-a1c3-95c1b9085f4a",
 InitializationCell->True],
Cell[9246, 282, 3565, 92, 454, "Input",ExpressionUUID->"58a37c1e-fe03-4d2e-af23-031428dc3f7c",
 InitializationCell->True],
Cell[12814, 376, 2739, 66, 667, "Input",ExpressionUUID->"ae494851-bc7d-4ec3-8b08-41a5e3d014bf",
 InitializationCell->True],
Cell[15556, 444, 6725, 172, 960, "Input",ExpressionUUID->"797e8a45-3ac6-42ad-9d9f-dcac415f5695",
 InitializationCell->True],
Cell[22284, 618, 17209, 410, 2177, "Input",ExpressionUUID->"41e6f6ee-aee7-473b-a67a-f5f9b9951d54",
 InitializationCell->True],
Cell[39496, 1030, 393, 9, 33, "Input",ExpressionUUID->"b7cba7ef-e555-45df-b783-3ccace02fcba"],
Cell[CellGroupData[{
Cell[39914, 1043, 218, 3, 33, "Input",ExpressionUUID->"94c1e997-a439-4feb-9f72-9f1bd081b5fe"],
Cell[40135, 1048, 418, 9, 38, "Output",ExpressionUUID->"d57d270e-e550-4908-92b1-8037db6ee03f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40590, 1062, 262, 4, 33, "Input",ExpressionUUID->"89d17443-768a-4837-ac0d-da17d0e39db4"],
Cell[40855, 1068, 371, 8, 38, "Output",ExpressionUUID->"12c51ba5-c3b2-4b06-a1e0-7352ce346168"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41263, 1081, 277, 4, 33, "Input",ExpressionUUID->"aa383b49-1e96-47b3-9e45-e915b3fee2f8"],
Cell[41543, 1087, 183, 3, 38, "Output",ExpressionUUID->"a316861c-8009-4464-a58b-cabd10de09db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41763, 1095, 247, 4, 33, "Input",ExpressionUUID->"1666932c-d2ce-4ef7-a98a-5286e4081973"],
Cell[42013, 1101, 168, 2, 38, "Output",ExpressionUUID->"57e7fadf-8590-4617-9ba2-07ff5faaf0a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42218, 1108, 530, 12, 57, "Input",ExpressionUUID->"e171c222-a874-4bcf-aff0-e8d55f191ced"],
Cell[42751, 1122, 153, 2, 38, "Output",ExpressionUUID->"1ee15afb-c0a6-4a18-921e-7255d9c3c90f"]
}, Open  ]],
Cell[42919, 1127, 665, 18, 94, "Input",ExpressionUUID->"3e9a34b0-c7c7-486f-b7e6-15521c838548"],
Cell[CellGroupData[{
Cell[43609, 1149, 569, 15, 33, "Input",ExpressionUUID->"d934c4a7-067f-4243-9897-93f8b7230660"],
Cell[44181, 1166, 5976, 150, 200, "Output",ExpressionUUID->"1d7be67e-4856-470d-b2fd-261264678925"]
}, Open  ]],
Cell[50172, 1319, 733, 19, 52, "Input",ExpressionUUID->"a1a10229-7ffc-4ff1-b40a-464cd41dc7ae"],
Cell[50908, 1340, 504, 14, 33, "Input",ExpressionUUID->"22707f06-484d-460f-80dd-3aca447b9179"],
Cell[CellGroupData[{
Cell[51437, 1358, 268, 6, 52, "Input",ExpressionUUID->"a64961a6-31b5-4dfc-b064-ee89eab97773"],
Cell[51708, 1366, 2245, 54, 276, "Output",ExpressionUUID->"8c485a07-f213-4b37-b19a-b941aa718094"]
}, Open  ]],
Cell[53968, 1423, 565, 15, 33, "Input",ExpressionUUID->"8e76a66f-2095-4e0b-aa20-a05eab1980c8"],
Cell[CellGroupData[{
Cell[54558, 1442, 431, 9, 52, "Input",ExpressionUUID->"2440f560-8c2b-4f5d-a847-a7e7ba9318e7"],
Cell[54992, 1453, 2975, 65, 273, "Output",ExpressionUUID->"15fcc536-25c6-4f91-a905-29c254ec79fe"]
}, Open  ]],
Cell[57982, 1521, 458, 10, 36, "Input",ExpressionUUID->"18ac679a-bedf-4922-bd97-91ca0b1aac8b"],
Cell[58443, 1533, 310, 6, 33, "Input",ExpressionUUID->"70c7ca92-423f-46bb-92ca-2aa837641d48"],
Cell[CellGroupData[{
Cell[58778, 1543, 1819, 41, 420, "Input",ExpressionUUID->"503e7c37-346b-4530-8d22-9026120f9053"],
Cell[60600, 1586, 461, 7, 38, "Output",ExpressionUUID->"ef0069cf-4a50-47f3-9188-ef2b00dba2a1"],
Cell[61064, 1595, 11403, 233, 369, "Output",ExpressionUUID->"6960f234-5b92-49b1-a1e8-a6ea19fc48ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72504, 1833, 1993, 48, 462, "Input",ExpressionUUID->"c2950aad-5c3f-48b5-b3f2-3109b1c07326"],
Cell[74500, 1883, 295, 5, 38, "Output",ExpressionUUID->"bfc84366-5471-4f19-90e5-4a03ecdc7168"],
Cell[74798, 1890, 11239, 231, 369, "Output",ExpressionUUID->"350cf701-b7cf-4a0b-b5ad-b58831d7642a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

